//A continuación la forma de crear dos instancias de mysql en Red Hat 7 

Primeramente se debe instalar mysql de forma natural, como si fueses a instalar cualquier otro programa.
si no lo recuerdas, a continucación te dejo los pasos:

primero se descarga el programa con wget http://repo.mysql.com/mysql57-community-release-el7-7.noarch.rpm
posteriomente procedemos a la instalación usando, rpm -ivh mysql57-community-release-el7-7.noarch.rpm

PASO 1
Una vez instalado paramos el servicio de mysql usando systemctl mysql stop


PASO 2
Para este paso necesitamos “quebrar” la estructura de ficheros que se tiene por defecto, normalmente ésta es la que se tiene:

/var/lib/mysql/
Donde debería quedar algo así, siendo los numeros secuenciales que yo pongo, cambiales por cualquier otro texto o nomenclatura.

Directorio de Datos: /var/lib/mysql/???
Para el tmpdir: /var/lib/mysql/tmp/???

/var
 |
  lib--+
          |
          mysql--+
                 |
                 +--001--+
                 |       |
                 |       +--mysql
                 |
                 +--002--+
                 |       |
                 |       +--mysql
                 .
                 .
                 +--tmp--+
                         |
                         +--001
                         +--002
                         .
                         .
                         
                 
PASO 3

Copiamos todo el directorio /var/lib/mysql/mysql a cada directorio /var/lib/mysql/???

PASO 4

En caso que existan estos ficheros, procedemos a su borrado:
rm /var/lib/mysql/mysql
rm /var/lib/mysql/ib_logfilex
rm /var/lib/mysql/ibdata1
rm /var/lib/mysql/mysql_u~de_info
rm /var/lib/mysql/mysql-bin.index

PASO 5

Reasignar dueño de los ficheros y sus permisos correspondientes, el usuario mysql debe tener el poder completo sobre ellos.

chown -R mysql.mysql /var/lib/mysql
 
chmod 700 /var/lib/mysql/mysql
chmod 700 /var/lib/mysql/001
chmod 700 /var/lib/mysql/002
chmod 700 /var/lib/mysql/tmp

PASO 6

Nos queda editar manualmente el archivo de configuración de MySQL

vim /etc/mysql/my.cnf ó /etc/my.cnf   (en Ubuntu)
vim /etc/my.cnf   (en openSuSE)
En ésta sección agregamos esto:

[mysqld_multi]
mysqladmin = /usr/bin/mysqladmin
user=root
password=password-del-root-de-mysql
log = /var/lib/mysql/multilog
Luego eliminamos todo lo que hay debajo de la sección

[mysqld]
Luego por cada instancia que instalamos agregamos el siguiente bloque:

# Instancia 001
[mysqld001]
server-id       = 001
replicate-do-db = db
user            = mysql
pid-file        = /var/run/mysqld/mysqld001.pid
socket          = /var/run/mysqld/mysqld001.sock
port            = 3301
basedir         = /usr
datadir         = /var/lib/mysql/001
tmpdir          = /var/lib/mysql/tmp/001
 
thread_cache_size       = 8
myisam-recover          = BACKUP
query_cache_limit       = 1M
query_cache_size        = 16M
 
expire_logs_days        = 10
max_binlog_size         = 100M
skip-federated
skip-name-resolve
# Fin Instancia

Nota: Por cada instancia se usa un puerto distinto, es recomendable seguir una secuencia, por ejemplo, la primer instancia 3301, la segunda 3302, 3303 y así sucesivamente.

PASO 7

Ahora sólo nos queda levantar los servicios y tener en cuenta ciertos aspectos para el mantenimiento.
# levantar todas las instancias
mysqld_multi start
 
# levantar una instancia especifica, según su id
mysqld_multi start 001
 
# detener todas las instancias
mysqld_multi stop
 
# detener una instancia especifica, según su id
mysqld_multi stop 001
 
# consultar el estado de las instancias
mysqld_multi report
 
# revisar el log de las instancias
vim /var/lib/mysql/multilog

Nota: una vez configurada las instancias, ya no podremos acceder a el mediante el comando mysql -u root -p

En cambio podemos hacerlo así mysql -uroot -p --perotocol=TCP -P 3301


Yo una ves hice el proceso me marcaba un error para levantar la instancia 001 copie nuevamente los archivos de mysql que le pertenecen
a 002 y con eso fue suficiente para mantener las dos instancias encendidas.


